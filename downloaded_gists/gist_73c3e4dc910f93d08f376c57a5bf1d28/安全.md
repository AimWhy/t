|     | ### 通用 | 是否涉及或符合 | check说明 |
| --- | --- | --- | --- |
|     | * **是否涉及个人信息（姓名，身份证，邮箱，手机号等）处理动作** |     |     |
| 1   | 直接或间接的，增加或变更用户基本信息的采集（账号、密码等） |     | 涉及打勾，并在技术文档中做出详细说明 |
| 2   | 直接或间接的，增加或变更用户生物信息的采集（面部、声音等） |     | 涉及打勾，并在技术文档中做出详细说明 |
| 3   | 直接或间接的，增加或变更个人身份信息的采集（身份证、姓名、地址等） |     | 涉及打勾，并在技术文档中做出详细说明 |
| 4   | 存在将用户信息输出到日志中的场景 |     | 涉及打勾，并在技术文档中对相关场景做出详细说明 |
| 5   | 如若涉及电话号码、身份证号码、银行卡号、护照等通行证号码、邮箱地址、真实姓名等敏感数据，必须进行脱敏；敏感数据列表：[敏感信息分级分类](/pages/viewpage.action?pageId=81550672) |     | 符合打勾 |
| 6   | 有 CSRF 防御策略 |     | 符合打勾 |
|     | ### 后端 |     |     |
|     | * **是否涉及读写缓存以及账号（非本系统）操作相关** |     |     |
| 7   | 存在数据缓存功能或场景 |     | 涉及打勾，并在技术文档中对相关场景做出详细说明 |
| 8   | 切换账号时，禁止使用或上传上一个账号的数据 |     | 符合打勾 |
| 9   | 缓存已做到账户级别的缓存信息隔离 |     | 符合打勾 |
| 10  | 数据库中存在明文的第三方账号与密码，以及明文密码 |     | 存在打勾，并在技术文档说明必须使用明文的必要性 |
|     | * 是否存在配置变更 |     |     |
| 11  | 线上配置文件变更 |     | 涉及打勾，并在技术文档中做出详细说明 |
| 12  | Apollo配置更新 |     | 涉及打勾，并在技术文档中做出详细说明 |
|     | * **是否存在URL路由相关操作** |     |     |
| 13  | 参数中存在 next/redirect_url 之类的参数 |     | 涉及打勾，并在技术文档中做出详细说明 |
| 14  | 参数值的 url 需要进行严格的白名单过滤 |     | 符合打勾 |
| 15  | 严格限制参数值的 url 的 scheme 为 http/https |     | 符合打勾 |
| 16  | 参数中存在相对路径或绝对路径相关的参数 |     | 涉及打勾，并在技术文档中做出详细说明 |
| 17  | 须验证路径中是否包含 ../ 或者..%2f 之类的字符串，避免绕过目录/资源限制 |     | 涉及打勾，并在技术文档中做出详细说明 |
| 18  | 使用严格的校验逻辑，或过滤/@/#等符号避免绕过限制加载第三方恶意页面 |     | 符合打勾 |
| 19  | 避免使用 nodeJS 自身的 url 模块，否则可能会导致绕过hostname检测 |     | 符合打勾 |
|     | * 数据收集范围是否有新增？ |     |     |
| 20  | 接口新增个人信息相关字段 |     | 涉及打勾，并在技术文档中做出详细说明 |
|     | * 传输与存储（必选） |     |     |
| 21  | url接口中带禁止包含访问数据，如applicationid、jobid等 |     | 符合打勾，不符合在技术文档中做出说明 |
| 22  | 涉及数据加解密机制（不含HTTPS）的新增或变更 |     | 涉及打勾，并在技术文档中做出详细说明 |
| 23  | 涉及增加或变更持久化存储、缓存、文件、日志中的存储结构 |     | 涉及打勾，并在技术文档中做出详细说明 |
| 24  | 不使用连续的资源ID。ID生成方式的推荐程度：随机化资源ID > ID生成器 > 连续资源ID |     | 符合打勾 |
| 25  | 前后端页面接口查询返回数据需保持一致，禁止存在多余数据（尤其注意敏感信息） |     | 符合打勾 |
| 26  | 消费类接口（发送邮件、短信等）要做访问频率限制 |     | 符合打勾 |
|     | * 是否涉及权限控制 |     |     |
| 27  | 新增或变更用户的权限策略（ACLs）、鉴权方式 |     | 涉及打勾，并在技术文档中做出详细说明 |
| 28  | 对外提供（实现）或集成（使用）OAuth机制 |     | 符合打勾 |
| 29  | 在服务端确认当前用户与当前操作资源的访问权限 |     | 符合打勾 |
| 30  | 按照权限最小化原则来实施访问控制 |     | 符合打勾 |
| 31  | 必须使用cookie鉴权，不依赖前端传参 |     | 符合打勾 |
|     | * 是否存在三方共享 |     |     |
| 32  | 存在调用第三方API的场景 |     | 涉及打勾，并在技术文档中做出详细说明 |
| 33  | 存在新增或变更第三方数据共享范围与场景，且与法务、安全确认 |     | 涉及打勾，并在技术文档中做出详细说明 |
| 34  | 直接或间接使用了第三方提供的代码、SDK |     | 涉及打勾，并在技术文档中做出详细说明 |
|     | * 是否涉及数据删除 |     |     |
| 35  | 删除用户数据且用户数据必须物理删除（硬删除），**此处数据不包含用户隐私协议同意日期** |     | 符合打勾 |
| 36  | 数据删除与定时任务无关联 |     | 符合打勾 |
|     | * 是否存在文件上传功能 |     |     |
| 37  | 文件上传后禁止直接传输到oss |     | 符合打勾 |
| 38  | 使用本地缓存上传，且在上传完成后删除缓存 |     | 符合打勾 |
| 39  | 文件上传出现失败但实际已将文件上传至oss，必须上传失败文件需在一周内删除 |     | 符合打勾 |
| 40  | 文件上传出现上传后用户删除已上传文件，或重新上传操作，必须将此类文件在一周内删除 |     | 符合打勾 |
| 41  | 只允许上传满足业务需要的相关文档类型 |     | 符合打勾 |
| 42  | 是否检查文件头信息，比如JPEG (jpg)文件头信息（十六进制）：FFD8FF，验证上传文档是否是所期待的类型 ；附文件上传类型白名单【候选人】【安全】指定文件格式允许上传 |     | 符合打勾 |
| 43  | 不要把文件保存在与应用程序相同的 Web 环境中，建议将文件保存在专用的文档服务器中，单独给文档服务器配置域名访问更好 |     | 符合打勾 |
| 44  | 限制上传可能被 Web 服务器解析的文件 ，比如jsp等 |     | 符合打勾 |
| 45  | 上传文件以二进制形式下载，建议不提供直接访问（防止木马文件直接执行） |     | 符合打勾 |
| 46  | 禁止授予上传文件存储目录的可执行权限 |     | 符合打勾 |
| 47  | 禁止客户端自定义文件上传/下载路径（如：使用../../../../进行跳转） |     | 符合打勾 |
| 48  | 文件上传后是否重命名，建议使用‘时间戳+文件名+orgid’进行md5的文件名 |     | 符合打勾 |
| 49  | 断约后需在合同约定好的时间，如六个月，将该客户系统内上传的所有数据文件进行彻底删除 |     | 符合打勾 |
| 50  | 文件上传后文件后缀必须使用源文件类型的后缀，禁止使用二进制代表所有文件类型 |     | 符合打勾 |
| 51  | 生成的文件上传链接是否有时间限制 |     | 符合打勾 |
|     | * 是否存在数据库相关操作 |     |     |
| 52  | 存在数据库操作并使用预编译语句防止sql注入 |     | 符合打勾 |
| 53  | 对于无法预编译的参数如表名、列名，必须设置白名单 |     | 符合打勾 |
|     | * 是否为发送验证码接口 |     |     |
| 54  | 一次一用，验证通过后当前验证码即刻失效 |     | 符合打勾 |
| 55  | 发送频率控制（建议60s获取一次，） |     | 符合打勾 |
| 56  | 验证码必须提供有效期（最多不超过15分钟，发短信时进行友好提示） |     | 符合打勾 |
| 57  | 复杂度（短信验证码建议6位数字） |     | 符合打勾 |
| 58  | 验证码有安全提示：“请勿将验证码转发或泄露给任何人” |     | 符合打勾 |
| 59  | 禁止前端校验，必须使用服务端代码对输入数据进行最终校验 |     | 符合打勾 |
| 60  | 短信验证码需要限制频率使用，例如：每天一个手机号码只允许发送5次，防止被黑客恶意消耗短信 |     | 符合打勾 |
| 61  | 不同场景的短信验证码不可通用 |     | 符合打勾 |
| 62  | 单个短信验证码限制有效验证次数为10次，10次以后当前验证码失效 |     | 符合打勾 |
| 63  | 验证码需要对应手机号不可通用 |     | 符合打勾 |
| 64  | 限制对短信接口的调用（1.推荐添加验证码保证需要人类交互才可以发送短信 2.根据自己的业务特点限制每个IP每天的最大发送量） |     | 符合打勾 |
| 65  | 禁止在日志中打印验证码 |     | 符合打勾 |
|     | ### 前端 |     |     |
|     | * 会话管理 |     |     |
| 66  | 服务器是否支持跨域请求 |     | 支持跨域打勾 |
| 67  | 需要对跨域的来源域名做严格限制 |     | 符合打勾 |
|     | * Cookie管理 |     |     |
| 68  | 存在新增 Cookie 且未设置 secure 与 httpOnly 属性 |     | 符合打勾 |
| 69  | 前后端页面接口查询返回数据需保持一致，禁止存在多余数据（敏感信息） |     | 符合打勾 |
|     | * **涉及引入新的第三方SDK** |     |     |
| 70  | 引入第三方SDK必须有标注 |     | 符合打勾 |
| 71  | 可能需要更新Cookie Banner（安全评估决定） |     | 符合打勾 |
| 72  | 禁止通过第三方SDK上报用户敏感信息，比如用户姓名、手机号等 |     | 符合打勾 |
| 73  | 禁止引入使用浏览器指纹技术的第三方SDK |     | 符合打勾 |
| 74  | 是否使用第三方跟踪技术/服务（如：Google Analytics），使用则需要法务、安全确认 |     | 符合打勾 |
|     | * **是否直接或间接地使用了浏览器指纹技术** |     |     |
| 75  | Canvas 指纹技术 |     | 涉及打勾 |
| 76  | WebRTC穿透技术 |     | 涉及打勾 |
| 77  | WebGL 硬件信息 |     | 涉及打勾 |
| 78  | 字体指纹信息 |     | 涉及打勾 |
| 79  | 如必须引入相关技术，需要法务、安全评估确认 |     | 涉及打勾 |
|     | * **通过浏览器提供的API或者JSBridge访问了系统能力或用户信息** |     |     |
| 80  | 收集下列信息或类似信息时，需进行法务合规、安全技术评审<br><br>地理位置、剪贴板、系统相册、文件系统、摄像头相关信息；用户敏感信息（姓名、手机号、设备ID、......） |     | 涉及打勾，并在技术文档中做出详细说明 |
| 81  | 调用了获取地理位置、剪贴板、系统相册、文件系统、摄像头相关信息的接口 |     | 涉及打勾，并在技术文档中做出详细说明 |
| 82  | 调用JSB获取用户敏感信息（姓名、手机号、设备ID、......） |     | 涉及打勾，并在技术文档中做出详细说明 |
|     | * **接口是否返回了用户数据** |     |     |
| 83  | 涉及电话号码、身份证号码、银行卡号、护照等通行证号码、邮箱地址、真实姓名等[敏感](https://wiki.mokahr.com/pages/viewpage.action?pageId=81550672)数据，必须使用**脱敏 （必须为后端返回结果就是脱敏结果） |     | 符合打勾 |
|     | * **是否存在文件上传功能** |     |     |
| 84  | 文件上传必须经过后端处理才能进行上传，禁止前端直接调用OSS存储 |     | 符合打勾 |
|     | * **是否存在直接或间接输出HTML富文本内容的场景** |     |     |
| 85  | 在网页中输出HTML富文本内容，必须对内容进行XSS过滤。推荐使用 Polaris 安全模块使用指南 |     | 符合打勾 |
|     | * **是否存在 301/302/303/307/308/ 前端 location 跳转** |     |     |
| 86  | 必须对跳转的目标进行严格的白名单校验 |     | 符合打勾 |
|     | * **接口是否为GET请求方式** |     |     |
| 87  | 禁止通过GET传输用户的数据，包括电话号码、身份证号码、银行卡号、护照等通行证号码、邮箱地址、真实姓名、密码、生日等敏感数据 |     | 符合打勾 |
| 88  | 禁止通过GET传输用户的身份凭证，包括session、token等信息 |     | 符合打勾 |
|     | **涉及轮询（Polling / Long Polling）请求** |     | 涉及打勾，并在技术文档中做出详细说明 |
|     | **涉及增加、变更 HTML5 硬件相关 API 的使用及其用途** |     | 涉及打勾，并在技术文档中做出详细说明 |
|     | **使用 Service Worker 技术** |     | 涉及打勾，并在技术文档中做出详细说明 |